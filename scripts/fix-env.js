#!/usr/bin/env node

/**
 * Script para corregir autom√°ticamente la configuraci√≥n de entorno
 */

import { writeFileSync } from 'fs';
import { join, dirname } from 'path';
import { fileURLToPath } from 'url';

const __dirname = dirname(fileURLToPath(import.meta.url));
const rootDir = join(__dirname, '..');

const envContent = `# üõ†Ô∏è DESARROLLO LOCAL - NO MODIFICAR
# Esta configuraci√≥n usa el proxy de Vite (vite.config.ts)
# Las peticiones van a /api/* y Vite las redirige autom√°ticamente

VITE_API_URL=/api
VITE_ENV=development

# ‚ö†Ô∏è IMPORTANTE: NUNCA cambies /api por una URL completa
# Para cambiar el backend de ngrok, edita vite.config.ts
`;

console.log('üîß Corrigiendo archivos de entorno...\n');

try {
  writeFileSync(join(rootDir, '.env'), envContent);
  console.log('‚úÖ .env corregido');
  
  writeFileSync(join(rootDir, '.env.development'), envContent);
  console.log('‚úÖ .env.development corregido');
  
  console.log('\n‚úÖ Configuraci√≥n restablecida correctamente');
  console.log('üí° Ahora ejecuta: npm run dev\n');
} catch (err) {
  console.error('‚ùå Error al corregir archivos:', err.message);
  process.exit(1);
}
